<?php/* ------------------------------------------------------------------------------------- *  Improve debugging * *  Turn on all debugging for developing purpose * ------------------------------------------------------------------------------------- */ini_set('display_errors', 1);ini_set('display_startup_errors', 1);error_reporting(-1);/* ------------------------------------------------------------------------------------- *  Allow huge memory * *  Since a lot of data is handled, the allowed memory in increased significantly * ------------------------------------------------------------------------------------- */ini_set('memory_limit', '1024M');set_time_limit(600);/* ------------------------------------------------------------------------------------- *  Config * ------------------------------------------------------------------------------------- *//* -------------------------------------------------------------------------------------*  Import the data**  Import the data from Zephyr and make it readable in PHP* ------------------------------------------------------------------------------------- */// descriptive('Import the data');// Import Excel data (csv)$code = utf8_decode(file_get_contents('fohlin5may2015.csv'));// Convert csv to arrays$rows = explode('', $code);foreach ($rows as &$row) {    $row = explode(';', $row);}// Remove the table heading// unset($rows[0]);// print_pre($rows);// -------------------------------------------------------------------------------------//     PRINT THE RESULT// -------------------------------------------------------------------------------------$persons = [];foreach ($rows as $row) {    $persons[$row[1] . ' ' . $row[2]]['places'][] = [        'fornamn' => $row[1],        'efternamn' => $row[2],        'kon' => $row[4],        'position' => $row[5],        'place' => $row[6],        'kluster' => $row[7],        'start' => $row[8],        'end' => $row[9]    ];}$nodes = [];foreach ($persons as $keyPerson => &$person) {    // echo '<br><br>-----------' . $keyPerson . '-----------<br>';    foreach ($person['places'] as $keyPlace => &$place) {        if (!empty($place['start'])) {            $place['move'] = '';            $place['from'] = '';            $place['to'] = '';            $place['fromPosition'] = '';            $place['toPosition'] = '';            $start = (int)$place['start'];            foreach ($person['places'] as $next) {                $nextStart = (int) $next['start'];                if ($start < $nextStart || empty($nextStart)) {                    // echo '<b>from: </b>' . $place['place'] . ' &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  <b>  to:</b> ' . $next['place'] . '<br>';                    // $persons[$keyPerson]['places'][$keyPlace]['next'][] = $next['place'];                    $place['move'] = $next['start'];                    $place['from'] =  $place['place'];                    $place['to'] =  $next['place'];                    $place['toPosition'] =  $next['position'];                    $place['fromPosition'] =  $place['position'];                    $place['toKluster'] =  $next['kluster'];                    $place['fromKluster'] =  $place['kluster'];                    $nodes[] = $place;                }            }        }    }}foreach($nodes as $nodeKey => $node){    unset($nodes[$nodeKey]['place']);    unset($nodes[$nodeKey]['next']);    unset($nodes[$nodeKey]['start']);    unset($nodes[$nodeKey]['end']);}// print_pre($nodes);echo '<table border="1">';echo '<thead>';echo '<tr>';echo '<th>fornamn</th>';echo '<th>efternamn</th>';echo '<th>kon</th>';echo '<th>from</th>';echo '<th>fromPosition</th>';echo '<th>fromKluster</th>';echo '<th>to</th>';echo '<th>toPosition</th>';echo '<th>toKluster</th>';echo '<th>move</th>';echo '</thead>';foreach ($nodes as $node) {    if(empty($node['from']))        continue;    echo '<tr>';    echo '<td>'. $node['fornamn'] . '</td>';    echo '<td>'. $node['efternamn'] . '</td>';    echo '<td>'. $node['kon'] . '</td>';    echo '<td>'. $node['from'] . '</td>';    echo '<td>'. $node['fromPosition'] . '</td>';    echo '<td>'. $node['fromKluster'] . '</td>';    echo '<td>'. $node['to'] . '</td>';    echo '<td>'. $node['toPosition'] . '</td>';    echo '<td>'. $node['toKluster'] . '</td>';    echo '<td>'. $node['move'] . '</td>';    echo '</tr>';}echo '</table>';function calculate($targets, $title = ''){    $numberOfTargets = count($targets);    $numberOfRounds = 0;    $numberOfAcquirers = 0;    foreach ($targets as $target) {        if (isset($target['fundingRounds'])) {            foreach ($target['fundingRounds'] as $round) {                $numberOfAcquirers += count($round['acquirers']);            }            $numberOfRounds += count($target['fundingRounds']);        }    }    echo '<div style="padding:20px; background: #aef2e9; border: solid 2px #4ecdbc; margin-bottom: 10px;"><b>COUNT - ' . $title . '</b><br>    Targets: ' . $numberOfTargets . '<br>    Rounds: ' . $numberOfRounds . '<br>    Investment decisions: ' . $numberOfAcquirers . '<br>    </div>';}function info($str){    echo '<div style="padding:20px; background: #b0d7fc; border: solid 2px #7aacdb; margin-bottom: 10px;">' . $str . '</div>';}function descriptive($str){    echo '<div style="padding:10px 20px; background: #f1f1f1; border: solid 2px #cccccc; margin-bottom: 10px;">' . $str . '</div>';}function filter($str){    echo '<div style="padding:10px 20px; background: #fcb0b2; border: solid 2px #ff5256; margin-bottom: 10px;">' . $str . '</div>';}function startsWith($haystack, $needle){    // search backwards starting from haystack length characters from the end    return $needle === "" || strrpos($haystack, $needle, -strlen($haystack)) !== FALSE;}function print_pre($str){    echo '<div style="padding:10px 20px; background: #f7f7f7; border: solid 2px #e3e3e3; margin-bottom: 10px; max-height: 300px; overflow: scroll">';    echo '<pre>';    print_r($str);    echo '</pre>';    echo '</div>';}